//
//  ChorusLabTargetTimeRow.swift
//  VoiceKitUI
//
//  Extracted from ChorusLabView to reduce type body length.
//
//  Generated by GPT-5 (OpenAI) — collaborator: rdoggett
//  date: 10-31-2025
//

import SwiftUI

@MainActor
internal struct ChorusLabTargetTimeRow: View {
    @Binding var targetSeconds: Double
    var isPlaying: Bool
    var lastChorusSeconds: Double?

    // Inject small layout/tuning knobs so this view has no dependency on ChorusLabView.Metrics.
    var targetRange: ClosedRange<Double>
    var targetStep: Double
    var actualMinWidth: CGFloat

    var body: some View {
        HStack(spacing: 8) {
            Text("Target Time")
                .font(.footnote)
                .lineLimit(1)
                .layoutPriority(1)
            Text(targetSeconds.asSeconds())
                .monospacedDigit()
                .foregroundStyle(.secondary)
            Stepper(value: $targetSeconds, in: targetRange, step: targetStep) {
                EmptyView()
            }
            .labelsHidden()
            .controlSize(.mini)
            .accessibilityLabel("Target time")
            .accessibilityHint("Adjust the target duration in seconds")

            Spacer()
            HStack(spacing: 6) {
                if isPlaying {
                    ProgressView().controlSize(.mini)
                }
                Text(lastChorusSeconds.map { $0.asSeconds() } ?? "—s")
                    .monospacedDigit()
                    .foregroundStyle(.secondary)
                    .lineLimit(1)
            }
            .frame(minWidth: actualMinWidth, alignment: .trailing)
            .accessibilityLabel("Actual time")
            .accessibilityValue(lastChorusSeconds.map { $0.asSeconds() } ?? "Not available")
        }
        .padding(.horizontal)
        .padding(.bottom, 4) // matches Metrics.Padding.headerV
    }
}
